<!DOCTYPE html>
<html>

<head>
    <title>Chart.js Tooltip Customization</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .tooltip-bold {
            font-weight: bold;
        }
    </style>
</head>

<body>
    <canvas id="myChart" width="600" height="400"></canvas>
    <script>
        var ctx = document.getElementById('myChart').getContext('2d');
        var unit_value = '$'; // 예제 단위
        var myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['2012', '2013', '2014', '2015', '2016', '2017', '2018'],
                datasets: [{
                    label: 'Series 1',
                    data: [30, 28, 29, 30, 40, 50, 55],
                    borderColor: 'blue',
                    fill: false
                }, {
                    label: 'Series 2',
                    data: [29, 27, 30, 30, 42, 52, 54],
                    borderColor: 'red',
                    fill: false
                }]
            },
            options: {
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function() {
                                return null;
                            },
                            label: function(context) {
                                var label = `${context.label} | ${context.dataset.label} ${context.formattedValue}<span class="tooltip-bold">${unit_value}</span>`;
                                return label;
                            }
                        },
                        // Allow HTML in the tooltip
                        external: function(context) {
                            // Tooltip Element
                            let tooltipEl = document.getElementById('chartjs-tooltip');

                            // Create element on first render
                            if (!tooltipEl) {
                                tooltipEl = document.createElement('div');
                                tooltipEl.id = 'chartjs-tooltip';
                                tooltipEl.innerHTML = '<table></table>';
                                document.body.appendChild(tooltipEl);
                            }

                            // Hide if no tooltip
                            const tooltipModel = context.tooltip;
                            if (tooltipModel.opacity === 0) {
                                tooltipEl.style.opacity = 0;
                                return;
                            }

                            // Set caret Position
                            tooltipEl.classList.remove('above', 'below', 'no-transform');
                            if (tooltipModel.yAlign) {
                                tooltipEl.classList.add(tooltipModel.yAlign);
                            } else {
                                tooltipEl.classList.add('no-transform');
                            }

                            function getBody(bodyItem) {
                                return bodyItem.lines;
                            }

                            // Set Text
                            if (tooltipModel.body) {
                                const bodyLines = tooltipModel.body.map(getBody);

                                let innerHtml = '<thead>';

                                bodyLines.forEach(function(body, i) {
                                    innerHtml += '<tr><td>' + body + '</td></tr>';
                                });
                                innerHtml += '</thead>';

                                let tableRoot = tooltipEl.querySelector('table');
                                tableRoot.innerHTML = innerHtml;
                            }

                            const position = context.chart.canvas.getBoundingClientRect();
                            tooltipEl.style.opacity = 1;
                            tooltipEl.style.position = 'absolute';
                            tooltipEl.style.left = position.left + window.pageXOffset + tooltipModel.caretX + 'px';
                            tooltipEl.style.top = position.top + window.pageYOffset + tooltipModel.caretY + 'px';
                            tooltipEl.style.fontFamily = tooltipModel.options.bodyFont.family;
                            tooltipEl.style.fontSize = tooltipModel.options.bodyFont.size + 'px';
                            tooltipEl.style.fontStyle = tooltipModel.options.bodyFont.style;
                            tooltipEl.style.padding = tooltipModel.padding + 'px ' + tooltipModel.padding + 'px';
                            tooltipEl.style.pointerEvents = 'none';
                        }
                    }
                }
            }
        });
    </script>
    <style>
        .chartjs-tooltip {
            opacity: 1;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 4px;
            padding: 10px;
            transition: opacity 0.3s;
            border: 1px solid red;
        }
    </style>
</body>

</html>